{"version":3,"sources":["modules/story/components/message-player/story-message-player.component.js"],"names":["angular","module","component","templateUrl","bindings","story","isComplete","controller","ctrl","sceneElementsHistory","sceneElements","applyChoice","choice","__wasSelected","setEnabled","concat","scene","elements","Array","containsWhere","e","_type","$onInit","content","isEnabled","forEach","__isEnabled","setSubsceneEnabled","action","subscene","reactions"],"mappings":";;AAAAA,QACEC,MADF,CACS,OADT,EAEEC,SAFF,CAEY,oBAFZ,EAEkC;AAChCC,cAAa,mEADmB;AAEhCC,WAAU;AACTC,SAAO,GADE;AAETC,cAAY;AAFH,EAFsB;AAMhCC,aAAY,sBAAW;AACtB,MAAIC,OAAO,IAAX;;AAEAA,OAAKC,oBAAL,GAA4B,EAA5B;AACAD,OAAKE,aAAL,GAAqB,EAArB;;AAEA;AACAF,OAAKG,WAAL,GAAmB,UAASC,MAAT,EAAiB;AACnCA,UAAOC,aAAP,GAAuB,IAAvB;;AAEAC,cAAWN,KAAKE,aAAhB,EAA+B,KAA/B;;AAEAF,QAAKC,oBAAL,GAA4BD,KAAKC,oBAAL,CAA0BM,MAA1B,CAAiCP,KAAKE,aAAtC,CAA5B;AACAF,QAAKE,aAAL,GAAqBE,OAAOI,KAAP,CAAaC,QAAlC;;AAEAH,cAAWN,KAAKE,aAAhB,EAA+B,IAA/B;;AAEAF,QAAKF,UAAL,GAAkBY,MAAMC,aAAN,CAAoBX,KAAKE,aAAzB,EAAwC;AAAA,WAAKU,EAAEC,KAAF,IAAW,KAAhB;AAAA,IAAxC,CAAlB;AACA,GAXD;;AAaAb,OAAKc,OAAL,GAAe,YAAW;AACzBd,QAAKE,aAAL,GAAqBF,KAAKH,KAAL,CAAWkB,OAAX,CAAmBP,KAAnB,CAAyBC,QAA9C;;AAEAH,cAAWN,KAAKE,aAAhB,EAA+B,IAA/B;AACAF,QAAKF,UAAL,GAAkB,KAAlB;AACA,GALD;;AAOA;AACA,WAASQ,UAAT,CAAoBG,QAApB,EAA8BO,SAA9B,EAAyC;AACxCP,YAASQ,OAAT,CAAiB,aAAK;AACrBL,MAAEM,WAAF,GAAgBF,SAAhB;;AAEA,QAAGJ,EAAEC,KAAF,IAAW,UAAd,EAA0B;AACzBM,wBAAmBP,CAAnB,EAAsBI,SAAtB;AACA,KAFD,MAEO,IAAGJ,EAAEC,KAAF,IAAW,QAAd,EAAwB;AAC9BM,wBAAmBP,EAAEQ,MAArB,EAA6BJ,SAA7B;AACAV,gBAAWM,EAAEJ,KAAF,CAAQC,QAAnB,EAA6BO,SAA7B;AACA;AACD,IATD;AAUA;;AAED,WAASG,kBAAT,CAA4BE,QAA5B,EAAsCL,SAAtC,EAAiD;AAChDK,YAASD,MAAT,CAAgBF,WAAhB,GAA8BF,SAA9B;AACAV,cAAWe,SAASC,SAApB,EAA+BN,SAA/B;AACA;AACD;AAnD+B,CAFlC","file":"story-message-player.component.js","sourcesContent":["angular\r\n\t.module(\"story\")\r\n\t.component(\"storyMessagePlayer\", {\r\n\t\ttemplateUrl: \"modules/story/components/message-player/story-message-player.html\",\r\n\t\tbindings: {\r\n\t\t\tstory: \"<\",\r\n\t\t\tisComplete: \"=\"\r\n\t\t},\r\n\t\tcontroller: function() {\r\n\t\t\tvar ctrl = this;\r\n\r\n\t\t\tctrl.sceneElementsHistory = [];\r\n\t\t\tctrl.sceneElements = [];\r\n\r\n\t\t\t// public methods\r\n\t\t\tctrl.applyChoice = function(choice) {\r\n\t\t\t\tchoice.__wasSelected = true;\r\n\t\t\t\r\n\t\t\t\tsetEnabled(ctrl.sceneElements, false);\r\n\r\n\t\t\t\tctrl.sceneElementsHistory = ctrl.sceneElementsHistory.concat(ctrl.sceneElements);\r\n\t\t\t\tctrl.sceneElements = choice.scene.elements;\r\n\r\n\t\t\t\tsetEnabled(ctrl.sceneElements, true);\t\t\t\t\r\n\r\n\t\t\t\tctrl.isComplete = Array.containsWhere(ctrl.sceneElements, e => e._type == \"End\");\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\tctrl.$onInit = function() {\r\n\t\t\t\tctrl.sceneElements = ctrl.story.content.scene.elements;\r\n\r\n\t\t\t\tsetEnabled(ctrl.sceneElements, true);\r\n\t\t\t\tctrl.isComplete = false;\r\n\t\t\t}\r\n\r\n\t\t\t// private methods\r\n\t\t\tfunction setEnabled(elements, isEnabled) {\r\n\t\t\t\telements.forEach(e => {\r\n\t\t\t\t\te.__isEnabled = isEnabled;\r\n\r\n\t\t\t\t\tif(e._type == \"Subscene\") {\r\n\t\t\t\t\t\tsetSubsceneEnabled(e, isEnabled);\r\n\t\t\t\t\t} else if(e._type == \"Choice\") {\r\n\t\t\t\t\t\tsetSubsceneEnabled(e.action, isEnabled);\r\n\t\t\t\t\t\tsetEnabled(e.scene.elements, isEnabled);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\tfunction setSubsceneEnabled(subscene, isEnabled) {\r\n\t\t\t\tsubscene.action.__isEnabled = isEnabled;\r\n\t\t\t\tsetEnabled(subscene.reactions, isEnabled);\r\n\t\t\t};\r\n\t\t}\r\n\t});"]}