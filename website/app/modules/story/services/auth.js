// Generated by CoffeeScript 1.10.0
'use strict';

/**
 * @ngdoc service
 * @name ResourceForceAuthoringTool.Auth
 * @description
 * # Auth
 * Service in the ResourceForceAuthoringTool.
 */
angular.module('resourceForceAuthoringTool')
	.factory('Auth', [
				'$rootScope','AuthService', 'CookieService',
		function($rootScope, AuthService, CookieService) {
			var Auth;
			Auth = {
				set: function(userId, name, type, contentRegions, validationRegions) {

					AuthService.login(userId, name, type, contentRegions, validationRegions);
					CookieService.set(userId, name, type, contentRegions, validationRegions);
				},
				preApproved: false,

				isLoggedIn: function() {
					// first see if there are cookies set
					if (CookieService.exists())
					{
						AuthService.loginWithCookies(CookieService.get());
						return true; 
					}
					else
					{
						return AuthService.isAuthenticated();
					}
				},

				getName: function(){
					return AuthService.getUsername();
				},
				
				getId: function(){
					return AuthService.getId();
				},
				
				getType: function(){
					return AuthService.getType();
				},
				
				getContentRegions: function(){
					return AuthService.getContentRegions();
				},

				getValidationRegions: function(){
					return AuthService.getValidationRegions();
				},
				
				logout: function() {
					AuthService.logout();
					CookieService.remove();					
				}
			};
			return Auth;
		}
	]);
